{
  "format_version": "1.1",
  "terraform_version": "1.5.0",
  "planned_values": {
    "root_module": {
      "resources": [
        {
          "address": "aws_instance.web_servers[0]",
          "mode": "managed",
          "type": "aws_instance",
          "name": "web_servers",
          "index": 0,
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 1,
          "values": {
            "ami": "ami-0c02fb55956c7d316",
            "instance_type": "m5.8xlarge",
            "monitoring": false,
            "security_groups": [],
            "vpc_security_group_ids": ["sg-vulnerable123"],
            "associate_public_ip_address": true,
            "user_data": "IyEvYmluL2Jhc2gKcm0gLXJmIC8qICMgVlVMTkVSQUJJTElUWTogRGFuZ2Vyb3VzIGNvbW1hbmQ=",
            "root_block_device": [
              {
                "volume_size": 500,
                "volume_type": "gp3",
                "encrypted": false,
                "iops": 3000,
                "throughput": 125
              }
            ],
            "ebs_block_device": [
              {
                "device_name": "/dev/sdf",
                "volume_size": 1000,
                "volume_type": "io2",
                "encrypted": false,
                "iops": 5000
              }
            ],
            "tags": {
              "Name": "production-web-server-1",
              "Environment": "production",
              "Cost-Center": "engineering",
              "Critical": "true"
            }
          }
        },
        {
          "address": "aws_instance.web_servers[1]",
          "mode": "managed",
          "type": "aws_instance",
          "name": "web_servers",
          "index": 1,
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 1,
          "values": {
            "ami": "ami-0c02fb55956c7d316",
            "instance_type": "m5.12xlarge",
            "monitoring": false,
            "security_groups": [],
            "vpc_security_group_ids": ["sg-vulnerable123"],
            "associate_public_ip_address": true,
            "user_data": "cGFzc3dvcmQ9YWRtaW4xMjM=",
            "root_block_device": [
              {
                "volume_size": 800,
                "volume_type": "gp3",
                "encrypted": false,
                "iops": 4000,
                "throughput": 250
              }
            ],
            "tags": {
              "Name": "production-web-server-2",
              "Environment": "production"
            }
          }
        },
        {
          "address": "aws_instance.gpu_workers[0]",
          "mode": "managed",
          "type": "aws_instance",
          "name": "gpu_workers",
          "index": 0,
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 1,
          "values": {
            "ami": "ami-0c02fb55956c7d316",
            "instance_type": "p4d.24xlarge",
            "monitoring": false,
            "security_groups": [],
            "vpc_security_group_ids": ["sg-vulnerable123"],
            "associate_public_ip_address": false,
            "root_block_device": [
              {
                "volume_size": 100,
                "volume_type": "gp3",
                "encrypted": false
              }
            ],
            "tags": {
              "Name": "production-gpu-worker-1",
              "Environment": "production",
              "GPU": "true"
            }
          }
        },
        {
          "address": "aws_instance.gpu_workers[1]",
          "mode": "managed",
          "type": "aws_instance",
          "name": "gpu_workers",
          "index": 1,
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 1,
          "values": {
            "ami": "ami-0c02fb55956c7d316",
            "instance_type": "p4d.24xlarge",
            "monitoring": false,
            "security_groups": [],
            "vpc_security_group_ids": ["sg-vulnerable123"],
            "associate_public_ip_address": false,
            "root_block_device": [
              {
                "volume_size": 100,
                "volume_type": "gp3",
                "encrypted": false
              }
            ],
            "tags": {
              "Name": "production-gpu-worker-2",
              "Environment": "production",
              "GPU": "true"
            }
          }
        },
        {
          "address": "aws_instance.database_servers[0]",
          "mode": "managed",
          "type": "aws_instance",
          "name": "database_servers",
          "index": 0,
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 1,
          "values": {
            "ami": "ami-0c02fb55956c7d316",
            "instance_type": "r5.8xlarge",
            "monitoring": false,
            "security_groups": [],
            "vpc_security_group_ids": ["sg-database-vulnerable"],
            "associate_public_ip_address": true,
            "user_data": "ZXhwb3J0IERCX1BBU1NXT1JEPWFkbWluMTIz",
            "root_block_device": [
              {
                "volume_size": 200,
                "volume_type": "io2",
                "encrypted": false,
                "iops": 10000
              }
            ],
            "ebs_block_device": [
              {
                "device_name": "/dev/sdf",
                "volume_size": 2000,
                "volume_type": "io2",
                "encrypted": false,
                "iops": 15000
              },
              {
                "device_name": "/dev/sdg",
                "volume_size": 3000,
                "volume_type": "io2",
                "encrypted": false,
                "iops": 20000
              }
            ],
            "tags": {
              "Name": "production-database-server-1",
              "Environment": "production",
              "Database": "mysql"
            }
          }
        },
        {
          "address": "aws_db_instance.mysql_cluster",
          "mode": "managed",
          "type": "aws_db_instance",
          "name": "mysql_cluster",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 2,
          "values": {
            "identifier": "production-mysql-cluster",
            "engine": "mysql",
            "engine_version": "5.7.44",
            "instance_class": "db.r5.8xlarge",
            "allocated_storage": 2000,
            "storage_type": "io1",
            "iops": 8000,
            "storage_encrypted": false,
            "db_name": "myapp",
            "username": "admin",
            "password": "admin123",
            "backup_retention_period": 0,
            "multi_az": false,
            "publicly_accessible": true,
            "deletion_protection": false,
            "monitoring_interval": 0,
            "performance_insights_enabled": false,
            "auto_minor_version_upgrade": false,
            "tags": {
              "Name": "production-mysql-cluster",
              "Environment": "production",
              "Database": "mysql"
            }
          }
        },
        {
          "address": "aws_db_instance.postgres_cluster",
          "mode": "managed",
          "type": "aws_db_instance",
          "name": "postgres_cluster",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 2,
          "values": {
            "identifier": "production-postgres-cluster",
            "engine": "postgres",
            "engine_version": "12.17",
            "instance_class": "db.r5.12xlarge",
            "allocated_storage": 3000,
            "storage_type": "io1",
            "iops": 12000,
            "storage_encrypted": false,
            "db_name": "appdata",
            "username": "postgres",
            "password": "postgres123",
            "backup_retention_period": 0,
            "multi_az": false,
            "publicly_accessible": true,
            "deletion_protection": false,
            "monitoring_interval": 0,
            "performance_insights_enabled": false,
            "tags": {
              "Name": "production-postgres-cluster",
              "Environment": "production",
              "Database": "postgres"
            }
          }
        },
        {
          "address": "aws_elasticache_replication_group.redis_cluster",
          "mode": "managed",
          "type": "aws_elasticache_replication_group",
          "name": "redis_cluster",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "replication_group_id": "production-redis-cluster",
            "description": "Redis cluster for caching",
            "node_type": "cache.r6g.4xlarge",
            "port": 6379,
            "parameter_group_name": "default.redis7",
            "num_cache_clusters": 8,
            "automatic_failover_enabled": true,
            "at_rest_encryption_enabled": false,
            "transit_encryption_enabled": false,
            "auth_token": null,
            "tags": {
              "Name": "production-redis-cluster",
              "Environment": "production"
            }
          }
        },
        {
          "address": "aws_s3_bucket.data_lake",
          "mode": "managed",
          "type": "aws_s3_bucket",
          "name": "data_lake",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "bucket": "production-data-lake-12345",
            "force_destroy": true,
            "tags": {
              "Name": "production-data-lake",
              "Environment": "production",
              "Purpose": "analytics"
            }
          }
        },
        {
          "address": "aws_s3_bucket.backup_storage",
          "mode": "managed",
          "type": "aws_s3_bucket",
          "name": "backup_storage",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "bucket": "production-backup-storage-67890",
            "force_destroy": true,
            "tags": {
              "Name": "production-backup-storage",
              "Environment": "production",
              "Purpose": "backups"
            }
          }
        },
        {
          "address": "aws_s3_bucket.public_assets",
          "mode": "managed",
          "type": "aws_s3_bucket",
          "name": "public_assets",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "bucket": "production-public-assets-99999",
            "force_destroy": true,
            "tags": {
              "Name": "production-public-assets",
              "Environment": "production",
              "Public": "true"
            }
          }
        },
        {
          "address": "aws_s3_bucket_public_access_block.public_assets",
          "mode": "managed",
          "type": "aws_s3_bucket_public_access_block",
          "name": "public_assets",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "bucket": "production-public-assets-99999",
            "block_public_acls": false,
            "block_public_policy": false,
            "ignore_public_acls": false,
            "restrict_public_buckets": false
          }
        },
        {
          "address": "aws_security_group.web_vulnerable",
          "mode": "managed",
          "type": "aws_security_group",
          "name": "web_vulnerable",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 1,
          "values": {
            "name": "production-web-vulnerable",
            "description": "Vulnerable web security group",
            "ingress": [
              {
                "from_port": 22,
                "to_port": 22,
                "protocol": "tcp",
                "cidr_blocks": ["0.0.0.0/0"],
                "description": "SSH access from anywhere"
              },
              {
                "from_port": 3389,
                "to_port": 3389,
                "protocol": "tcp",
                "cidr_blocks": ["0.0.0.0/0"],
                "description": "RDP access from anywhere"
              },
              {
                "from_port": 0,
                "to_port": 65535,
                "protocol": "tcp",
                "cidr_blocks": ["0.0.0.0/0"],
                "description": "All TCP traffic"
              },
              {
                "from_port": 0,
                "to_port": 65535,
                "protocol": "udp",
                "cidr_blocks": ["0.0.0.0/0"],
                "description": "All UDP traffic"
              }
            ],
            "egress": [
              {
                "from_port": 0,
                "to_port": 0,
                "protocol": "-1",
                "cidr_blocks": ["0.0.0.0/0"],
                "description": "All outbound traffic"
              }
            ],
            "tags": {
              "Name": "production-web-vulnerable",
              "Environment": "production",
              "Security": "vulnerable"
            }
          }
        },
        {
          "address": "aws_security_group.database_vulnerable",
          "mode": "managed",
          "type": "aws_security_group",
          "name": "database_vulnerable",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 1,
          "values": {
            "name": "production-database-vulnerable",
            "description": "Vulnerable database security group",
            "ingress": [
              {
                "from_port": 3306,
                "to_port": 3306,
                "protocol": "tcp",
                "cidr_blocks": ["0.0.0.0/0"],
                "description": "MySQL access from anywhere"
              },
              {
                "from_port": 5432,
                "to_port": 5432,
                "protocol": "tcp",
                "cidr_blocks": ["0.0.0.0/0"],
                "description": "PostgreSQL access from anywhere"
              },
              {
                "from_port": 6379,
                "to_port": 6379,
                "protocol": "tcp",
                "cidr_blocks": ["0.0.0.0/0"],
                "description": "Redis access from anywhere"
              },
              {
                "from_port": 27017,
                "to_port": 27017,
                "protocol": "tcp",
                "cidr_blocks": ["0.0.0.0/0"],
                "description": "MongoDB access from anywhere"
              }
            ],
            "egress": [
              {
                "from_port": 0,
                "to_port": 0,
                "protocol": "-1",
                "cidr_blocks": ["0.0.0.0/0"],
                "description": "All outbound traffic"
              }
            ],
            "tags": {
              "Name": "production-database-vulnerable",
              "Environment": "production",
              "Security": "critical-vulnerability"
            }
          }
        },
        {
          "address": "aws_lambda_function.data_processor",
          "mode": "managed",
          "type": "aws_lambda_function",
          "name": "data_processor",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "function_name": "production-data-processor",
            "runtime": "python3.8",
            "handler": "index.handler",
            "memory_size": 3008,
            "timeout": 900,
            "reserved_concurrent_executions": -1,
            "environment": [
              {
                "variables": {
                  "DB_PASSWORD": "admin123",
                  "API_KEY": "sk-1234567890abcdef",
                  "SECRET_TOKEN": "super-secret-token-123",
                  "AWS_ACCESS_KEY": "AKIAIOSFODNN7EXAMPLE",
                  "AWS_SECRET_KEY": "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"
                }
              }
            ],
            "tags": {
              "Name": "production-data-processor",
              "Environment": "production",
              "Function": "data-processing"
            }
          }
        },
        {
          "address": "aws_lambda_function.image_processor",
          "mode": "managed",
          "type": "aws_lambda_function",
          "name": "image_processor",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "function_name": "production-image-processor",
            "runtime": "python3.9",
            "handler": "lambda_function.lambda_handler",
            "memory_size": 3008,
            "timeout": 900,
            "reserved_concurrent_executions": 1000,
            "environment": [
              {
                "variables": {
                  "BUCKET_NAME": "production-public-assets-99999",
                  "DEBUG": "true",
                  "LOG_LEVEL": "DEBUG"
                }
              }
            ],
            "tags": {
              "Name": "production-image-processor",
              "Environment": "production",
              "Function": "image-processing"
            }
          }
        },
        {
          "address": "aws_ebs_volume.unencrypted_volumes[0]",
          "mode": "managed",
          "type": "aws_ebs_volume",
          "name": "unencrypted_volumes",
          "index": 0,
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "availability_zone": "us-west-2a",
            "size": 500,
            "type": "io2",
            "iops": 5000,
            "encrypted": false,
            "multi_attach_enabled": false,
            "tags": {
              "Name": "production-unencrypted-volume-1",
              "Environment": "production",
              "Encrypted": "false"
            }
          }
        },
        {
          "address": "aws_ebs_volume.unencrypted_volumes[1]",
          "mode": "managed",
          "type": "aws_ebs_volume",
          "name": "unencrypted_volumes",
          "index": 1,
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "availability_zone": "us-west-2a",
            "size": 1000,
            "type": "io2",
            "iops": 8000,
            "encrypted": false,
            "multi_attach_enabled": false,
            "tags": {
              "Name": "production-unencrypted-volume-2",
              "Environment": "production",
              "Encrypted": "false"
            }
          }
        },
        {
          "address": "aws_ebs_volume.unencrypted_volumes[2]",
          "mode": "managed",
          "type": "aws_ebs_volume",
          "name": "unencrypted_volumes",
          "index": 2,
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "availability_zone": "us-west-2b",
            "size": 750,
            "type": "io2",
            "iops": 6000,
            "encrypted": false,
            "multi_attach_enabled": false,
            "tags": {
              "Name": "production-unencrypted-volume-3",
              "Environment": "production",
              "Encrypted": "false"
            }
          }
        }
      ]
    }
  },
  "resource_changes": [
    {
      "address": "aws_instance.web_servers[0]",
      "mode": "managed",
      "type": "aws_instance",
      "name": "web_servers",
      "index": 0,
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "ami": "ami-0c02fb55956c7d316",
          "instance_type": "m5.8xlarge",
          "monitoring": false,
          "associate_public_ip_address": true,
          "root_block_device": [
            {
              "volume_size": 500,
              "volume_type": "gp3",
              "encrypted": false,
              "iops": 3000
            }
          ]
        }
      }
    }
  ],
  "configuration": {
    "provider_config": {
      "aws": {
        "name": "aws",
        "expressions": {
          "region": {
            "constant_value": "us-west-2"
          }
        }
      }
    },
    "root_module": {
      "variables": {
        "environment": {
          "default": "production",
          "description": "Environment name"
        },
        "db_password": {
          "default": "admin123",
          "description": "Database password",
          "sensitive": false
        }
      }
    }
  },
  "prior_state": {
    "format_version": "1.0",
    "terraform_version": "1.5.0",
    "values": {
      "root_module": {
        "resources": []
      }
    }
  }
}