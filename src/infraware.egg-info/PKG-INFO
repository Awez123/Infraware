Metadata-Version: 2.4
Name: infraware
Version: 0.1.0
Summary: An IaC Security and Quality Scanner.
Author-email: Awez Ahmed Khan <awezkhan786jb@gmail.com>, Ikram Hyderi <mdikramhyderi@gmail.com>
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: typer[all]
Requires-Dist: pyyaml
Requires-Dist: rich
Dynamic: license-file

# ðŸ›¡ï¸ InfraWare - Enterprise Infrastructure Security & Cost Platform# ðŸ›¡ï¸ InfraWare - Enterprise Infrastructure Security & Cost Platform



[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)

[![Version](https://img.shields.io/badge/version-2.0.0-green.svg)](https://github.com/Awez123/Infraware)[![Version](https://img.shields.io/badge/version-2.0.0-green.svg)](https://github.com/Awez123/Infraware)



**InfraWare** is an enterprise-grade Infrastructure as Code (IaC) security scanner with integrated CVE database. It combines infrastructure vulnerability detection with cost analysis to provide comprehensive cloud security insights.



## ðŸš€ Quick Start## ðŸš€ Quick Start



### Installation### Installation

```bash```bash

# Clone the repository# Clone the repository

git clone https://github.com/Awez123/Infraware.gitgit clone https://github.com/Awez123/Infraware.git

cd Infrawarecd Infraware



# Install dependencies# Install dependencies

pip install -e .pip install -e .



# Verify installation# Verify installation

infraware --helpinfraware --help

``````



### Basic Usage### Basic Usage

```bash```bash

# Scan Terraform plan for security issues# Scan Terraform plan for security issues

infraware scan terraform-plan.jsoninfraware scan terraform-plan.json



# Comprehensive security scan with CVE correlation# Comprehensive security scan with CVE correlation

infraware comprehensive ./infrastructureinfraware comprehensive ./infrastructure



# Update CVE database# Update CVE database

infraware cve-updateinfraware cve-update



# View database statistics# View database statistics

infraware cve-statsinfraware cve-stats

``````



## ðŸŽ¯ Key Features



### ðŸ” Infrastructure Security## ðŸš€ Key Features## ðŸš€ Key Features

- **Multi-Cloud IaC Scanning**: Terraform, CloudFormation, Kubernetes YAML

- **CVE Integration**: 10,000+ vulnerabilities with real-time updates

- **Risk Scoring**: Advanced severity assessment and scoring

- **Compliance Mapping**: CIS Controls and industry standards### ðŸ” Infrastructure Security### ðŸ” Infrastructure Security

- **35+ AWS Security Rules**: Comprehensive coverage across RDS, EC2, IAM, Lambda, ELB, CloudTrail, KMS
- **Multi-Cloud IaC Scanning**: Terraform, CloudFormation, Kubernetes YAML
- **CVE Integration**: 10,000+ vulnerabilities with real-time updates
- **Risk Scoring**: Advanced severity assessment and scoring
- **Secret Detection**: Hardcoded credentials and sensitive data identification
- **Compliance Mapping**: CIS Controls and industry standards

### ðŸ’° Cost Analysis

- **Multi-Cloud Cost Estimation**: AWS, Azure, GCP pricing
- **Resource Optimization**: Cost-aware security recommendations
- **Regional Pricing**: Location-specific cost calculations
- **Usage-Based Modeling**: Flexible time-based cost projections

### ðŸ”„ Real-Time Intelligence

- **CVE Database**: Auto-updating vulnerability intelligence from NVD and GitHub
- **Threat Correlation**: Infrastructure resources mapped to known vulnerabilities
- **Security Scoring**: Dynamic risk assessment based on current threat landscape

## ðŸ“‹ Command Reference



| Command | Description | Example |

|---------|-------------|---------|

| `scan` | Infrastructure vulnerability scanning | `infraware scan plan.json` |### ðŸ’° Cost Analysis### ðŸ’° Cost Analysis

| `comprehensive` | Multi-faceted security scan | `infraware comprehensive ./infrastructure` |

| `cost-analysis` | Cloud cost estimation | `infraware cost-analysis plan.tf --region us-east-1` |- **Multi-Cloud Cost Estimation**: AWS, Azure, GCP pricing- **Multi-Cloud Cost Estimation**: AWS, Azure, GCP pricing

| `cve-update` | Update CVE database | `infraware cve-update` |

| `cve-bulk-download` | Download enterprise CVE database | `infraware cve-bulk-download` |- **Resource Optimization**: Cost-aware security recommendations- **Resource Optimization**: Cost-aware security recommendations

| `cve-search` | Search CVE database | `infraware cve-search "kubernetes" --severity CRITICAL` |

| `cve-stats` | CVE database statistics | `infraware cve-stats` |- **Regional Pricing**: Location-specific cost calculations- **Regional Pricing**: Location-specific cost calculations

| `container-scan` | Container image scanning | `infraware container-scan alpine:latest` |

| `dockerfile-scan` | Dockerfile security analysis | `infraware dockerfile-scan Dockerfile` |- **Usage-Based Modeling**: Flexible time-based cost projections- **Usage-Based Modeling**: Flexible time-based cost projections

| `container-runtime` | Running container analysis | `infraware container-runtime web-app` |

| `secrets` | Secret detection | `infraware secrets ./src --format json` |



## ðŸ”§ Detailed Usage Examples### ðŸ”„ Real-Time Intelligence### ðŸ”„ Real-Time Intelligence



### Infrastructure Scanning- **CVE Database**: Auto-updating vulnerability intelligence from NVD and GitHub- **CVE Database**: Auto-updating vulnerability intelligence from NVD and GitHub



#### Basic Terraform Scan- **Threat Correlation**: Infrastructure resources mapped to known vulnerabilities- **Threat Correlation**: Infrastructure resources mapped to known vulnerabilities

```bash

# Generate Terraform plan and scan- **Security Scoring**: Dynamic risk assessment based on current threat landscape- **Security Scoring**: Dynamic risk assessment based on current threat landscape

terraform plan -out=tfplan.binary

terraform show -json tfplan.binary > tfplan.json

infraware scan tfplan.json

```## ðŸ“¦ Installation*(Tip: You can use a tool like [ScreenToGif](https://www.screentogif.com/) or [Peek](https://github.com/phw/peek) to create a simple GIF of your tool in action and replace the placeholder above.)*



#### Comprehensive AWS Security Scan

```bash

# Scan with comprehensive AWS security rules (35+ rules)```bash- **Security Scanning**: Detect vulnerabilities and misconfigurations in Terraform files

infraware scan comprehensive_aws_test.json

# Clone the repository

# Expected output: Detection of 27 vulnerabilities across:

# - RDS instances (encryption, public access, backups)git clone https://github.com/ikramhyderi/Infraware.git- **Cost Analysis**: Calculate monthly costs for cloud resources with region-aware pricing## âœ¨ Key Features

# - EC2 instances (monitoring, IMDSv2, encryption)

# - IAM policies (admin access, overprivileged users)cd Infraware

# - Lambda functions (DLQ, roles, VPC, encryption)

# - ALB/ELB (HTTPS, logging, redirects)- **Multiple Format Support**: Works with Terraform (.tf), JSON, and YAML files

# - CloudTrail (logging, encryption, validation)

# - KMS/Secrets (rotation, encryption)# Install dependencies

```

pip install -r requirements.txt- **Rule-Based Engine**: Extensible rules system with confidence scoring* **Accurate Plan Scanning**: Analyzes the JSON output of `terraform plan` to understand the exact state of your infrastructure, including modules and variables.

#### Multi-Format Support

```bash

# Terraform JSON

infraware scan infrastructure.json# Install InfraWare- **Professional CLI**: Clean command-line interface with detailed help* **Extensible Rule Engine**: Define security and quality checks in simple, human-readable YAML files.



# CloudFormation YAMLpip install -e .

infraware scan cloudformation-template.yaml

```* **Professional CLI**: A full-featured command-line interface with commands for scanning and rule management.

# Kubernetes YAML

infraware scan k8s-deployment.yaml

```

## ðŸŽ¯ Quick Start## Requirements* **Interactive Rule Creation**: Use `infraware rules create` to be guided through making new rules.

### CVE Database Operations



#### Update Database

```bash### Infrastructure Scanning* **Rule Validation**: Use `infraware rules validate` to check your custom rule files for correct syntax.

# Quick update (recent CVEs)

infraware cve-update```bash



# Force update# Scan Terraform plan- Python 3.8 or higher* **Ignore Findings**: Baseline your infrastructure by ignoring specific findings using simple ignore files.

infraware cve-update --force

infraware scan terraform-plan.json

# Enterprise download (100K+ CVEs, 3 years)

infraware cve-bulk-download- Terraform (for Terraform file analysis)* **Formatted Output**: Clean, color-coded console output makes it easy to spot issues.

```

# Scan with JSON output

#### Search and Statistics

```bashinfraware scan infrastructure.tf --format json

# Search for specific vulnerabilities

infraware cve-search "apache" --severity HIGH --limit 10```



# Search by technology## Installation## ðŸ“‹ Prerequisites

infraware cve-search "kubernetes" --severity CRITICAL

### Cost Analysis

# View database statistics

infraware cve-stats```bash



# Expected output:# Analyze costs for AWS us-east-1

# Total CVEs: 12,547

# Recent CVEs (30 days): 234infraware cost-analysis terraform-plan.tf --region us-east-1 --hours 7201. Clone the repository:* [Python](https://www.python.org/downloads/) (version 3.8 or higher)

# Database Size: 45.2 MB

# Severity Distribution: Critical(15%), High(25%), Medium(45%), Low(15%)

```

# Multi-cloud cost analysis```bash* [Terraform](https://developer.hashicorp.com/terraform/downloads) (version 1.0 or higher)

### Container Security

infraware cost-analysis multi-cloud.json --provider aws --region us-west-2

#### Container Image Scanning

```bash```git clone https://github.com/your-username/infraware.git

# Scan Docker image

infraware container-scan nginx:latest



# Scan with layer analysis### CVE Database Operationscd infraware## ðŸš€ Installation

infraware container-scan ubuntu:20.04 --layers

```bash

# Output to JSON

infraware container-scan alpine:3.14 --format json# Update CVE database```

```

infraware cve-update

#### Dockerfile Analysis

```bashTo install and use the InfraWare CLI, follow these steps:

# Scan Dockerfile for security issues

infraware dockerfile-scan Dockerfile# Search for specific vulnerabilities



# Common findings:infraware cve-search "apache" --severity HIGH --limit 52. Install the package:

# - Running as root user

# - Using ADD instead of COPY

# - No health check defined

# - Hardcoded secrets# View database statistics```bash1.  **Clone the Repository**:

```

infraware cve-stats

#### Runtime Container Security

```bash```pip install -e .    ```bash

# Scan running container

infraware container-runtime container-name



# Scan by container ID### Container Security```    git clone [https://github.com/your-username/infraware.git](https://github.com/your-username/infraware.git)

infraware container-runtime abc123def456

``````bash



### Secret Detection# Scan Dockerfile for security issues    cd infraware



```bashinfraware dockerfile-scan Dockerfile

# Scan directory for secrets

infraware secrets ./src3. Verify installation:    ```



# Scan specific file# Comprehensive container scan

infraware secrets config.py

infraware container-scan nginx:latest```bash

# Output to JSON

infraware secrets ./app --format json



# Common findings:# Runtime container analysisinfraware --help2.  **Install the Package**:

# - API keys in configuration files

# - Database passwords in source codeinfraware container-runtime container-id

# - OAuth tokens in environment files

# - SSH keys in repositories``````    This command uses the `pyproject.toml` file to install the `infraware` command and its dependencies.

```



### Cost Analysis

### Secret Detection    ```bash

```bash

# Analyze Terraform file costs```bash

infraware cost-analysis file main.tf --region us-east-1

# Scan directory for secrets## Quick Start    pip install .

# Estimate specific resource costs

infraware cost-analysis estimate aws aws_instance --type t3.medium --region us-west-2infraware secrets /path/to/code



# Multi-cloud cost comparison    ```

infraware cost-analysis estimate gcp google_compute_instance --type e2-medium

infraware cost-analysis estimate azure azurerm_virtual_machine --type Standard_B2s# Comprehensive security scan



# Export cost analysisinfraware comprehensive terraform-plan.json### Security Scanning

infraware cost-analysis file infrastructure.tf --format json > costs.json

infraware cost-analysis file infrastructure.tf --format csv > costs.csv```

```

3.  **Verify Installation**:

### Comprehensive Security Scanning

## ðŸ“Š Command Reference

```bash

# Complete security assessment1. Generate a Terraform plan:    Check that the command is available in your path.

infraware comprehensive ./infrastructure

| Command | Purpose | Example |

# Includes:

# - Infrastructure vulnerability scanning|---------|---------|---------|```bash    ```bash

# - Secret detection

# - CVE correlation| `scan` | Infrastructure vulnerability scanning | `infraware scan plan.json` |

# - Security scoring

# - Recommendations| `cost-analysis` | Cloud cost estimation | `infraware cost-analysis plan.tf --hours 720` |terraform plan -out=tfplan.binary    infraware --help



# Output to JSON for automation| `cve-update` | Update CVE database | `infraware cve-update` |

infraware comprehensive ./project --format json

```| `cve-search` | Search CVE database | `infraware cve-search "kubernetes" --severity CRITICAL` |terraform show -json tfplan.binary > tfplan.json    ```



## ðŸ›¡ï¸ AWS Security Coverage| `cve-stats` | CVE database statistics | `infraware cve-stats` |



InfraWare provides comprehensive AWS security scanning with **35+ security rules** across major services:| `container-scan` | Container image scanning | `infraware container-scan alpine:latest` |```



### RDS Security (5 rules)| `dockerfile-scan` | Dockerfile security analysis | `infraware dockerfile-scan Dockerfile` |

- âœ… Database encryption at rest

- âœ… Public accessibility checks| `container-runtime` | Running container analysis | `infraware container-runtime web-app` |## ðŸ”¬ Usage Guide

- âœ… Backup retention validation

- âœ… Multi-AZ deployment| `secrets` | Secret detection | `infraware secrets ./src --format json` |

- âœ… Default port usage

| `comprehensive` | Multi-faceted security scan | `infraware comprehensive infrastructure/` |2. Run security scan:

### EC2 Security (4 rules)

- âœ… Detailed monitoring

- âœ… IMDSv2 enforcement

- âœ… Root volume encryption## ðŸ“ˆ Comparison with Trivy```bashInfraWare is designed to fit into your standard Terraform workflow.

- âœ… Public IP assignment



### IAM Security (5 rules)

- âœ… Admin access detection| Feature | InfraWare | Trivy | Advantage |infraware scan tfplan.json

- âœ… Wildcard permissions

- âœ… External ID validation|---------|-----------|-------|-----------|

- âœ… Programmatic access keys

- âœ… Unused credentials| **CVE Database** | 2,000+ (growing) | 180,000+ | Trivy (larger) |```### Scanning a Terraform Project



### Lambda Security (5 rules)| **IaC Scanning** | Advanced Terraform/CF | Basic IaC support | InfraWare |

- âœ… Dead letter queue configuration

- âœ… Role permissions review| **Cost Analysis** | âœ… Multi-cloud | âŒ Not available | InfraWare |

- âœ… VPC configuration

- âœ… Environment variable encryption| **Container Security** | âœ… Full platform | âœ… Excellent | Tie |

- âœ… Memory allocation optimization

| **Real-time Updates** | âœ… Auto-updating | âœ… Regular updates | Tie |### Cost Analysis1.  **Navigate to Your Terraform Project**:

### ELB/ALB Security (5 rules)

- âœ… HTTPS listener enforcement| **Enterprise Features** | âœ… Cost + Security | âœ… SBOM, attestation | Tie |

- âœ… Access logging

- âœ… HTTP to HTTPS redirects    `cd` into the directory containing your `.tf` files.

- âœ… Security group configuration

- âœ… SSL/TLS policy validation## ðŸ—ï¸ Architecture



### Logging Security (5 rules)1. Analyze infrastructure costs:

- âœ… CloudTrail enablement

- âœ… Log encryptionInfraWare uses a hybrid approach for maximum effectiveness:

- âœ… Log file validation

- âœ… CloudWatch retention```bash2.  **Initialize Terraform**:

- âœ… Monitoring configuration

### External Database Commands (Real-time)

### KMS/Secrets Security (4 rules)

- âœ… Key rotation policies- `cve-update`, `cve-search`, `cve-stats` - NVD, GitHub Security Advisoriesinfraware cost-analysis file main.tf --region us-west-2    If you haven't already, initialize Terraform to download providers and modules.

- âœ… Secret rotation

- âœ… Encryption configuration- `container-scan`, `container-runtime` - Docker APIs, package managers

- âœ… Access policies

```    ```bash

## ðŸ“Š Output Examples

### Local Database Commands (Fast & Offline)

### Security Scan Results

```- `scan` - Local security rules (rules/*.yaml)    terraform init

ðŸ›¡ï¸ Security Scan Summary

Total Vulnerabilities: 27- `cost-analysis` - Local pricing data (config/pricing/*.yaml)

Risk Score: 5.0/10.0

- `dockerfile-scan`, `secrets` - Hardcoded patterns for speed2. Estimate specific resources:    ```

Severity Distribution:

  ðŸ”´ Critical: 2

  ðŸŸ  High: 5

  ðŸŸ¡ Medium: 16## ðŸ¤ Contributing```bash

  ðŸ”µ Low: 4



ðŸš¨ CRITICAL VULNERABILITIES:

- AWS-IAM-001: IAM User With Full Admin Access1. Fork the repositoryinfraware cost-analysis estimate aws aws_instance --type t3.medium3.  **Generate the JSON Plan**:

- AWS-RDS-002: RDS Instance Publicly Accessible

```2. Create a feature branch (`git checkout -b feature/amazing-feature`)



### CVE Database Statistics3. Commit your changes (`git commit -m 'Add amazing feature'`)```    Create a binary plan file and convert it to a readable JSON format.

```

ðŸ“Š CVE Database Statistics4. Push to the branch (`git push origin feature/amazing-feature`)

Total CVEs: 12,547

Recent CVEs (30 days): 2345. Open a Pull Request    ```bash

Database Size: 45.2 MB

Last Update: 2025-10-03 14:30:15



Severity Distribution:## ðŸ“„ License3. Check supported providers and regions:    terraform plan -out=tfplan.binary

Critical: 1,854 (15%)

High: 3,137 (25%)

Medium: 5,646 (45%)

Low: 1,910 (15%)This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.```bash    terraform show -json tfplan.binary > tfplan.json

```



## ðŸ”§ Getting Help

## ðŸ‘¥ Authorsinfraware cost-analysis providers    ```

Every command has detailed help available:



```bash

# General help- **Awez Ahmed Khan** - *Initial work* - awezkhan786jb@gmail.com```

infraware --help

- **Ikram Hyderi** - *Enhanced development* - mdikramhyderi@gmail.com

# Command-specific help

infraware scan --help4.  **Run the Scanner**:

infraware cve-update --help

infraware cost-analysis --help## ðŸ™ Acknowledgments

infraware comprehensive --help

```## Available Commands    Now, use the `infraware` command to run the scan.



## ðŸ“ File Format Support- **NIST NVD** for vulnerability data



### Supported Infrastructure Files- **GitHub Security Advisories** for threat intelligence    ```bash

- `.tf` - Terraform configuration files

- `.json` - Terraform plan files, infrastructure JSON- **Cloud providers** for pricing transparency

- `.yaml/.yml` - CloudFormation templates, Kubernetes manifests

- **Open source community** for continuous improvement### Security Commands    infraware scan ./tfplan.json --rules-dir /path/to/your/rules --ignore-dir /path/to/your/ignores

### Supported Cloud Providers

- **AWS** - Amazon Web Services (aws_* resources)

- **GCP** - Google Cloud Platform (google_* resources) 

- **Azure** - Microsoft Azure (azurerm_* resources)---- `infraware scan` - Scan files for security vulnerabilities    ```



## ðŸ¤ Contributing



1. Fork the repository*InfraWare: Where Infrastructure Security Meets Cost Intelligence* ðŸš€- `infraware rules list` - List available security rules    **Example**:

2. Create a feature branch (`git checkout -b feature/amazing-feature`)

3. Commit your changes (`git commit -m 'Add amazing feature'`)- `infraware rules validate` - Validate rule files    ```bash

4. Push to the branch (`git push origin feature/amazing-feature`)

5. Open a Pull Request- `infraware rules create` - Create new security rules    infraware scan ./tfplan.json --rules-dir ~/dev/infraware/rules --ignore-dir ./infraware-ignores



## ðŸ“„ License    ```



This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.### Cost Analysis Commands



## ðŸ‘¥ Authors- `infraware cost-analysis file` - Analyze costs from infrastructure files### Managing Rules



- **Awez Ahmed Khan** - *Initial work* - awezkhan786jb@gmail.com- `infraware cost-analysis estimate` - Estimate costs for specific resources

- **Ikram Hyderi** - *Enhanced development* - mdikramhyderi@gmail.com

- `infraware cost-analysis providers` - List supported cloud providers and regionsInfraWare includes a full suite of commands to help you manage your rules.

## ðŸ™ Acknowledgments

- `infraware cost-analysis metadata` - Show pricing data sources

- **NIST NVD** for vulnerability data

- **GitHub Security Advisories** for threat intelligence- `infraware cost-analysis confidence` - Display data quality reports#### **Listing Rules**

- **Cloud providers** for pricing transparency

- **Open source community** for continuous improvementSee all rules in a directory in a clean table format.



---## File Format Support```bash



*InfraWare: Where Infrastructure Security Meets Cost Intelligence* ðŸš€infraware rules list --rules-dir ./my-rules

### Supported File Types```

- `.tf` - Terraform configuration files

- `.json` - Terraform plan files, infrastructure JSON#### **Validating Rules**

- `.yaml/.yml` - CloudFormation templates, Kubernetes manifestsCheck a directory of rule files for correct syntax and structure.

```bash

### Supported Cloud Providersinfraware rules validate --rules-dir ./my-rules

- **AWS** - Amazon Web Services (aws_* resources)```

- **GCP** - Google Cloud Platform (google_* resources)

- **Azure** - Microsoft Azure (azurerm_* resources)#### **Creating a Rule Interactively**

Be guided through creating a new rule, which will be saved to a new YAML file.

## Cost Analysis Examples```bash

infraware rules create --rules-dir ./my-rules

### Basic File Analysis```

```bash

# Analyze Terraform file## ðŸ“„ Rule and Ignore File Formats

infraware cost-analysis file infrastructure.tf

#### **Rule File Format**

# With specific regionRules are defined in YAML files. A single file can contain a list of multiple rules.

infraware cost-analysis file main.tf --region us-east-1

*Example (`rules/aws_s3_public.yaml`):*

# Export to JSON```yaml

infraware cost-analysis file plan.json --format json- id: AWS-S3-001

  severity: HIGH

# Export to CSV  description: "S3 bucket has a public read ACL."

infraware cost-analysis file resources.tf --format csv  resource: "aws_s3_bucket"

```  attribute: "acl"

  value: "public-read"

### Resource Cost Estimation```

```bash

# AWS EC2 instance#### **Ignore File Format**

infraware cost-analysis estimate aws aws_instance --type t3.medium --region us-east-1Ignore files allow you to baseline findings. A finding is ignored if the resource's **name** matches.



# GCP compute instance*Example (`ignores/s3-exceptions.yaml`):*

infraware cost-analysis estimate gcp google_compute_instance --type e2-medium```yaml

ignore:

# Azure virtual machine  - resource_name: "my_public_website_bucket"

infraware cost-analysis estimate azure azurerm_virtual_machine --type Standard_B2s    reason: "This bucket is for a public website and is intentionally public."

```

# Storage with size

infraware cost-analysis estimate aws aws_ebs_volume --type gp3 --size 500## ðŸ› ï¸ Development Setup

```

Interested in contributing to InfraWare? Hereâ€™s how to set up for development.

### Data Quality and Sources

```bash1.  **Clone the Repository**:

# Check pricing data quality    ```bash

infraware cost-analysis confidence --min-confidence 8    git clone [https://github.com/your-username/infraware.git](https://github.com/your-username/infraware.git)

    cd infraware

# View pricing metadata    ```

infraware cost-analysis metadata aws --resource aws_instance2.  **Create and Activate a Virtual Environment**:

    ```bash

# List all supported regions    python -m venv venv

infraware cost-analysis providers    source venv/bin/activate  # or .\venv\Scripts\activate on Windows

```    ```

3.  **Install in Editable Mode**:

## Configuration    Install the project in "editable" mode (`-e`). This allows you to make changes to the source code and see them reflected immediately without reinstalling.

    ```bash

### Security Rules    pip install -e .

Rules are defined in YAML files in the `rules/` directory:    ```



```yaml## ðŸ¤ Contributing

- id: AWS-S3-001

  severity: HIGHContributions are welcome! Please feel free to open an issue to discuss a new feature or submit a pull request.

  description: "S3 bucket has public read access"

  resource: "aws_s3_bucket"## ðŸ“œ License

  attribute: "acl"

  value: "public-read"This project is licensed under the MIT License. See the `LICENSE` file for details.

```

### Cost Pricing Data
Pricing configurations are stored in `config/pricing/` directory:
- `aws_pricing.yaml` - AWS resource pricing
- `gcp_pricing.yaml` - GCP resource pricing
- `azure_pricing.yaml` - Azure resource pricing

Each pricing file includes:
- Resource pricing data
- Confidence scores (1-10 scale)
- Last verification dates
- Official documentation links
- Regional pricing multipliers

## Output Formats

### Table Format (Default)
Rich formatted tables with confidence scores and metadata.

### JSON Format
Machine-readable output for automation:
```bash
infraware cost-analysis file main.tf --format json > costs.json
```

### CSV Format
Spreadsheet-compatible output:
```bash
infraware cost-analysis file main.tf --format csv > costs.csv
```

## Regional Pricing

InfraWare supports region-aware pricing for accurate cost estimates:

```bash
# Compare costs across regions
infraware cost-analysis estimate aws aws_instance --type t3.medium --region us-east-1
infraware cost-analysis estimate aws aws_instance --type t3.medium --region eu-west-1
infraware cost-analysis estimate aws aws_instance --type t3.medium --region ap-southeast-1
```

## Data Quality Features

### Confidence Scoring
All pricing data includes confidence scores (1-10) indicating data accuracy:
- 10/10: Official provider pricing, recently verified
- 8-9: High confidence, official sources
- 6-7: Good confidence, may need verification
- 4-5: Medium confidence, estimated pricing
- 1-3: Low confidence, rough estimates

### Impact Levels
- `low`: Minimal cost impact
- `medium`: Moderate cost impact
- `high`: Significant cost impact
- `variable`: Cost depends on usage
- `fixed`: Fixed monthly cost

## Development Setup

1. Clone and enter directory:
```bash
git clone https://github.com/your-username/infraware.git
cd infraware
```

2. Create virtual environment:
```bash
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
```

3. Install in development mode:
```bash
pip install -e .
```

## Help and Documentation

Get help for any command:
```bash
infraware --help
infraware cost-analysis --help
infraware cost-analysis file --help
```

Detailed documentation is available in `docs/COST_ANALYSIS_GUIDE.md`.

## Contributing

Contributions are welcome! Please feel free to submit issues and pull requests.

## License

This project is licensed under the MIT License. See the LICENSE file for details.
